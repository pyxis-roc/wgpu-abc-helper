# SPDX-FileCopyrightText: 2024 University of Rochester
#
# SPDX-License-Identifier: MIT
language = "C++"

# REUSE-IgnoreStart
header = "// SPDX-FileCopyrightText: 2024 University of Rochester \n//\n// SPDX-License-Identifier: MIT\n"
# REUSE-IgnoreEnd
pragma_once = true
autogen_warning = "/* Warning, this file is autogenerated by cbindgen. Don't modify this manually. */"
# namespace = "wgpu_constraints"
documentation = true
# no_includes = true
# sys_includes = ["cstdint", "cstdarg"]
namespace = "abc_helper"
include_version = true
usize_is_size_t = true

[export]
# FfiStr and CString are just a wrappers around const char*
# FfiTerm and FfiAbcType should be renamed to Term and AbcType, as they are just FFI interfaces to these types.
rename = { "FfiStr" = "const char*", "CString" = "const char*"}
# renaming_overrides_prefixing = true
exclude = ["WrappedInterval", "Predicate", "AbcScalar"]

[parse.expand]
crates = ["abc-helper"]
features = ["cffi"]

[enum]
derive_helper_methods = true
derive_const_casts = true

[export.pre_body]
"FfiTerm" = """
  auto get_id() {
    return this->id;
  }
private:
"""
"FfiAbcType" = """
  auto get_id() {
    return this->id;
  }
private:
"""

"FFISummary" = """
  auto get_id() {
    return this->id;
  }
private:
"""

"Context" = """
  auto get_id() {
    return this->id;
  }
private:
"""


[export.body]
"Context" = """
public:
  MaybeTerm new_unit_pred(FfiTerm term);
  MaybeTerm new_literal_true();
  MaybeTerm new_literal_false();
  MaybeTerm new_logical_and(FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_logical_or(FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_comparison(CmpOp op, FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_not(FfiTerm t);
  MaybeTerm new_var(const char* s);
  MaybeTerm new_cast(FfiTerm source_term, FfiAbcType ty);
  MaybeTerm new_cmp_term(CmpOp op, FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_index_access(FfiTerm base, FfiTerm index);
  MaybeTerm new_struct_access(FfiTerm base, const char* field, FfiAbcType ty, size_t field_idx);
  MaybeTerm new_splat(FfiTerm term, uint32_t size);
  MaybeTerm new_literal(Literal lit);
  MaybeTerm new_binary_op(BinaryOp op, FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_unary_op(UnaryOp op, FfiTerm term);
  MaybeTerm new_max(FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_min(FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_select(FfiTerm iftrue, FfiTerm iffalse, FfiTerm predicate);
  MaybeTerm new_vec2(FfiTerm term_0, FfiTerm term_1, FfiAbcType ty);
  MaybeTerm new_vec3(FfiTerm term_0, FfiTerm term_1, FfiTerm term_2, FfiAbcType ty);
  MaybeTerm new_vec4(FfiTerm term_0, FfiTerm term_1, FfiTerm term_2, FfiTerm term_3, FfiAbcType ty);
  MaybeTerm new_array_length(FfiTerm term);
  MaybeTerm new_array_store(FfiTerm base, FfiTerm index, FfiTerm value);
  MaybeTerm new_store(FfiTerm base, const char* field, size_t field_idx, FfiTerm value);
  MaybeTerm new_struct_store(FfiTerm base, size_t field_idx, FfiTerm value);
  MaybeTerm new_abs(FfiTerm term);
  MaybeTerm new_pow(FfiTerm base, FfiTerm exponent);
  MaybeTerm new_dot(FfiTerm lhs, FfiTerm rhs);
  MaybeTerm new_mat2x2(FfiTerm row_0, FfiTerm row_1, FfiAbcType ty);
  MaybeTerm new_mat2x3(FfiTerm row_0, FfiTerm row_1, FfiAbcType ty);
  MaybeTerm new_mat2x4(FfiTerm row_0, FfiTerm row_1, FfiAbcType ty);
  MaybeTerm new_mat3x2(FfiTerm row_0, FfiTerm row_1, FfiTerm row_2, FfiAbcType ty);
  MaybeTerm new_mat3x3(FfiTerm row_0, FfiTerm row_1, FfiTerm row_2, FfiAbcType ty);
  MaybeTerm new_mat3x4(FfiTerm row_0, FfiTerm row_1, FfiTerm row_2, FfiAbcType ty);
  MaybeTerm new_mat4x2(FfiTerm row_0, FfiTerm row_1, FfiTerm row_2, FfiTerm row_3, FfiAbcType ty);
  MaybeTerm new_mat4x3(FfiTerm row_0, FfiTerm row_1, FfiTerm row_2, FfiTerm row_3, FfiAbcType ty);
  MaybeTerm new_mat4x4(FfiTerm row_0, FfiTerm row_1, FfiTerm row_2, FfiTerm row_3, FfiAbcType ty);
  MaybeAbcType new_Scalar_type(uint8_t width, AbcScalar::Tag tag);
  MaybeAbcType new_Struct_type(const char* *fields, const FfiAbcType *types, size_t num_fields);
  MaybeAbcType new_SizedArray_type(FfiAbcType ty, uint32_t size);
  MaybeAbcType new_DynamicArray_type(FfiAbcType ty);
  char *term_to_cstr(FfiTerm term);
"""